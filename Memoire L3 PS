# suivez l'algorithme que je vous ai donné

 # simule déjà un échatillon de la loi exponentielle à partir de cette commande existante dans R;
  # ce qui vous ai demandé c'est de vous même créer un code de simulation
 
##Simulation d'une loi exponentielle
Sim_loi_exp=function(n,lambda) # n= la taille de l'echantillon , lambda= une valeur pour le parametre de la loi exponentielle 
{
  
  u=runif(n,0,1) # simulation d'un echantillon d'une loi uniforme
  x=-log(u)/lambda # simulation d'un echantillon de la loi exponentielle 
   
  return(x)
  
  
}
 *****
# exemple 1:
n=10
lambda=5
Y=Sim_loi_exp(n,lambda)
# calcul de la variance empirique
var(Y) 
# calcul de la moyenne emirique
mean(Y) 
# avoir la discription statistique de l'echantillon  
summary(Y)
*****
# representation graphique :
par(mfrow=c(2,2))
plot(Y,type = "h",main = "simulation d'une loi exponentielle")
hist(Y,freq = F, main = "simulation d'une loi exponentielle", col = "lightblue")
boxplot(Y,col="red", border=3)
barplot(Y,col=1:10)
##Simulation d'une loi Normale
Sim_Loi_norm=function(n,m,sigma)
  {
  u1 = runif(n)
  u2 =runif(n)
  r2=Sim_loi_exp(n,1/2)
  Z1=sqrt(r2) * cos(2*pi*u2)
  Z2=sqrt(r2) * sin(2*pi*u2)
  X=m+sigma*c(Z1,Z2)  
  return(X)
}
##Qst2

 D=Sim_Loi_norm(1000,10,2) ## n=1000 m=10 sigma=2

  hist(D, col="thistle4" , proba=TRUE ,main=" N(m,sigma) ") ## L'histogramme de l echantillon


  curve(dnorm(x,10,sqrt(2)), add = TRUE) ## trace la densite de la loi normale N(m,sigma)

**** Question4*****
Test_Nor=function(Pvalue,alpha)
{
H=NULL
if(Pvalue>alpha)
{H=1}
else{H=0}
return(H)
}
  ##Qst 5
  n=20
 m=0
sigma=1
S=0
alpha=0.05
pvalue=vector("logical",1000)
for(i in 1:1000) { 
  x=Sim_Loi_norm(20,0,1)
  Test_ks=ks.test(x,"pnorm",mean=0,sd=sqrt(1))
  
  pvalue[i]=Test_ks$p.value
  He=Test_Nor(pvalue[i],alpha)#tester normalite 
  S=He+S
  
  
}
Prop=S/1000
   
